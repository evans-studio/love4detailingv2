import { config } from 'dotenv';
import { resolve } from 'path';
import { EmailService } from './services/email';
import { formatPrice } from './utils';
import type { Booking } from '@/types';

// Load environment variables from .env.local
config({ path: resolve(process.cwd(), '.env.local') });

const testBooking: Booking = {
  id: 'test-booking-id',
  user_id: null,
  vehicle_id: 'test-vehicle-id',
  time_slot_id: 'test-timeslot-id',
  vehicle_size_id: 'test-size-id',
  status: 'pending',
  payment_status: 'pending',
  payment_method: 'card',
  total_price_pence: 9999,
  booking_reference: 'TEST-123',
  email: 'paul@evans-studio.co.uk', // Replace with your email
  full_name: 'Test User',
  phone: '+44123456789',
  created_at: new Date().toISOString(),
  updated_at: new Date().toISOString(),
  vehicles: {
    make: 'BMW',
    model: 'M3',
    registration: 'TEST123'
  },
  available_slots: {
    slot_date: '2024-03-25',
    start_time: '10:00',
    end_time: '12:00'
  }
};

async function testEmailService() {
  console.log('Testing email service...');
  
  const emailService = new EmailService();
  
  try {
    console.log('Sending test booking confirmation email...');
    await emailService.sendBookingConfirmation(testBooking);
    console.log('✅ Test booking confirmation email sent successfully!');
  } catch (error) {
    console.error('❌ Error sending test email:', error);
  }
}

testEmailService(); 